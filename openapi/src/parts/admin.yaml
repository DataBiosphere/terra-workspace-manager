## admin
paths:
  /api/admin/v1/workspaces/cloudcontexts/syncIamRoles:
    patch:
      parameters:
        - $ref: '#/components/parameters/DryRun'
      summary: Sync iam roles of all workspaces.
      operationId: syncIamRoles
      tags: [Admin]
      responses:
        '200':
          $ref: '#/components/responses/SyncIamRolesResultResponse'
        '202':
          $ref: '#/components/responses/SyncIamRolesResultResponse'
        '403':
          $ref: '#/components/responses/PermissionDenied'
        '500':
          $ref: '#/components/responses/ServerError'
components:
  schemas:
    SyncIamRolesResult:
      type: object
      description: |
        The result of a call to sync iam roles of all the existing workspace's
        GCP projects.
      properties:
        jobReport:
          $ref: '#/components/schemas/JobReport'
        errorReport:
          $ref: '#/components/schemas/ErrorReport'

  parameters:
    DryRun:
      name: DryRun
      in: query
      description: Whether this is a dry run
      required: false
      schema:
        type: boolean
        default: true

  responses:
    SyncIamRolesResultResponse:
      description: Job is completed (succeeded or failed)
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/SyncIamRolesResult'
